<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BFS | Safety Stand-Down</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  margin:0;
  background:#f4f6f8;
  color:#1F2A44;
}

header{
  background:#C8102E;
  color:#fff;
  padding:14px;
  text-align:center;
}

.drive{
  background:#1F2A44;
  color:#fff;
  text-align:center;
  padding:6px;
  font-size:13px;
  letter-spacing:1px;
}

.raleigh{
  background:#C8102E;
  color:#fff;
  text-align:center;
  padding:6px;
  font-size:12px;
  font-weight:600;
}

.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}

.section{
  background:#fff;
  border:2px solid #C8102E;
  border-radius:10px;
  padding:18px;
  margin-bottom:20px;
  box-shadow:0 4px 10px rgba(0,0,0,0.05);
}

.section-title{
  font-size:18px;
  font-weight:700;
  margin-bottom:10px;
  color:#C8102E;
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}

label{
  font-weight:600;
  font-size:14px;
  display:block;
  margin-top:10px;
}

input, select, textarea{
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:14px;
}

button{
  width:100%;
  padding:14px;
  background:#C8102E;
  color:#fff;
  font-weight:700;
  border:none;
  border-radius:8px;
  margin-top:20px;
  cursor:pointer;
}

button:hover{
  background:#a50e25;
}

canvas{
  border:2px solid #C8102E;
  border-radius:8px;
  background:#fff;
  margin-top:10px;
}

.small{ font-size:12px; color:#666; }
</style>
</head>

<body>

<header>
  <h1>Builders FirstSource</h1>
  <div>Safety Stand-Down</div>
</header>

<div class="drive">DRIVE TO ZERO</div>
<div class="raleigh">RALEIGH INSTALL SERVICES</div>

<div class="container" id="pdfContent">

<!-- PROJECT INFO -->
<div class="section">
  <div class="section-title">Project Information / Informaci√≥n del Proyecto</div>
  <div class="grid">
    <div><label>Date / Fecha</label><input type="date"></div>
    <div><label>BFS Rep</label><input></div>
    <div><label>Customer / Cliente</label><input></div>
    <div><label>Project / Proyecto</label><input id="jobsite"></div>
    <div><label>Lot / Lote</label><input></div>
    <div><label># Workers</label><input type="number"></div>
  </div>
</div>

<!-- SIGNATURE PAD -->
<div class="section">
  <div class="section-title">Supervisor Signature / Firma</div>
  <canvas id="signaturePad" width="800" height="200"></canvas>
  <button type="button" onclick="clearSignature()">Clear Signature</button>
</div>

<!-- SAVE BUTTON -->
<button id="savePdfBtn">Save Safety Stand Down (PDF)</button>

</div>

<!-- SIGNATURE PAD SCRIPT -->
<script>
const canvas = document.getElementById("signaturePad");
const ctx = canvas.getContext("2d");
let drawing = false;

canvas.addEventListener("mousedown", ()=> drawing=true);
canvas.addEventListener("mouseup", ()=> drawing=false);
canvas.addEventListener("mousemove", draw);

canvas.addEventListener("touchstart", ()=> drawing=true);
canvas.addEventListener("touchend", ()=> drawing=false);
canvas.addEventListener("touchmove", function(e){
  e.preventDefault();
  draw(e.touches[0]);
});

function draw(e){
  if(!drawing) return;
  const rect = canvas.getBoundingClientRect();
  ctx.lineWidth = 2;
  ctx.lineCap = "round";
  ctx.strokeStyle = "#000";
  ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
}

function clearSignature(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
}
</script>

<!-- PDF LIBRARIES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- PDF GENERATION -->
<script>
document.getElementById("savePdfBtn").addEventListener("click", async ()=>{
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF("p","pt","a4");

  const btn = document.getElementById("savePdfBtn");
  btn.style.display="none";

  const element = document.getElementById("pdfContent");
  const htmlCanvas = await html2canvas(element,{ scale:0.9 });

  btn.style.display="block";

  const imgData = htmlCanvas.toDataURL("image/jpeg",0.6);
  const sigData = document.getElementById("signaturePad").toDataURL("image/png");

  const pageWidth = pdf.internal.pageSize.getWidth();
  const pageHeight = pdf.internal.pageSize.getHeight();
  const imgWidth = pageWidth;
  const imgHeight = (htmlCanvas.height * imgWidth) / htmlCanvas.width;

  let heightLeft = imgHeight;
  let position = 60;
  let pageNumber = 1;

  while(heightLeft > 0){

    // HEADER WITH BFS LOGO TEXT
    pdf.setFontSize(16);
    pdf.text("Builders FirstSource",40,30);
    pdf.setFontSize(10);
    pdf.text("Raleigh Install Services | Drive to Zero",40,45);

    // PAGE NUMBER
    pdf.setFontSize(10);
    pdf.text("Page " + pageNumber, pageWidth-70, pageHeight-10);

    // MAIN CONTENT
    pdf.addImage(imgData,"JPEG",0,position,imgWidth,imgHeight,"","FAST");

    heightLeft -= pageHeight;
    position -= pageHeight;
    pageNumber++;

    if(heightLeft > 0) pdf.addPage();
  }

  // ADD SIGNATURE IMAGE AT END
  pdf.addPage();
  pdf.setFontSize(14);
  pdf.text("Supervisor Signature",40,50);
  pdf.addImage(sigData,"PNG",40,70,300,100);

  pdf.save("BFS_Safety_Stand_Down.pdf");
});
</script>

</body>
</html>
